---
import Layout from '../layouts/Layout.astro'
import Sidebar from '../components/Sidebar.astro'
//import PortableText from '../components/PortableText.jsx'
import { PortableText } from 'astro-portabletext'
import {client} from '../lib/sanityClient.js'
//import Q2 from '@component/Q2'
import Image from '../components/Image.jsx'

import { aboutPageQuery, allPagesQuery } from '../lib/queries.js'
import AstroImage from '../components/AstroImage.astro'

// const query = await client.fetch(aboutPageQuery)
// const page = query[0]

export async function getStaticPaths() {
  const allPages = await client.fetch(allPagesQuery)

  return allPages.map(page => ({params: { page: page.slug.current }, props: {page}}))
}
const { page } = Astro.props

---
<Layout title={page.title} type={page._type} description={page.excerpt} image={page.featuredImage} pathname={page.slug.current}>
  <div class="content-area wrapper grid-wrapper grid-main">
    <main id="main" class="site-main" role="main">
      <article>
        <header class="entry-header">
          <h1 class="entry-title">{page.title}</h1>
        </header>

        <div class="entry-content">
          <PortableText 
            value={page.content}
            components={{
              type: {
                //imageFull: Image,
                image: AstroImage,
                //video: VideoBlock,
                //gallery: GalleryBlock,
                //googleMyMap: MapBlock,
                //instagramPost: InstagramBlock,
                //videoEmbed: VideoEmbedBlock,
                //mapbox: Mapbox,
                //quotation: Q2,
                //break: Break,
                //embed: Embed,
              }
            }}
          />
          <!-- <PortableText blocks={page.content} client:load/> -->
        </div>

      </article>
    </main>
    <Sidebar />
  </div>
</Layout>